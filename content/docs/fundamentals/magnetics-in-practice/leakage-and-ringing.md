---
title: "Leakage, Stray Capacitance & Ringing"
weight: 30
---

# Leakage, Stray Capacitance & Ringing

Every real transformer and inductor has parasitic elements that don't appear in the schematic symbol: leakage inductance from imperfect magnetic coupling, capacitance between turns and between windings, and capacitance from windings to core. These parasitics are usually negligible at low frequencies but dominate behavior at switching speeds, causing voltage spikes, ringing, EMI, and waveform distortion.

## Leakage Inductance

### What It Is

In an ideal transformer, all magnetic flux generated by the primary links to the secondary — perfect coupling. In a real transformer, some flux escapes through air paths, leaking out of the core. This uncoupled flux appears as a series inductance on each winding, separate from the mutual inductance that transfers energy.

The coupling coefficient k describes how much flux is shared. k = 1 is perfect coupling (no leakage), k = 0 is no coupling (two independent inductors). Real transformers achieve k = 0.95–0.999, depending on construction. The leakage inductance on each winding is roughly:

L_leakage ≈ L_winding × (1 - k)

For a transformer with a 1 mH primary and k = 0.99, the primary leakage inductance is about 10 µH. That sounds small, but at fast switching speeds it's enough to cause serious problems.

### Why It Matters

Leakage inductance stores energy (½ × L_leak × I²) that can't transfer to the secondary through the core. When current through the winding is interrupted — as it is every switching cycle in a switching power supply — this stored energy has to go somewhere. If there's no designed current path, the voltage across the switch rises until something breaks down:

V_spike = L_leak × dI/dt

A 10 µH leakage inductance with current dropping from 2 A to 0 A in 50 ns produces a 400 V spike. This is why every switching converter with a transformer needs a snubber or clamp circuit — the spike is a direct consequence of leakage inductance.

### What Affects Leakage Inductance

- **Winding separation:** More physical distance between primary and secondary means more leakage. Windings wound on opposite sides of a bobbin have much higher leakage than interleaved windings
- **Interleaving:** Sandwiching secondary turns between primary turns (P-S-P or P-S-P-S-P) dramatically reduces leakage by keeping the magnetic paths short
- **Core shape:** Toroidal cores with tightly wound windings have very low leakage. E-cores with bobbins have higher leakage because the bobbin creates space between windings and the core
- **Winding technique:** Tight, uniform windings with no voids or bunching have lower leakage than sloppy windings

In inductors (single winding), leakage inductance isn't a separate concern — the total inductance is the inductance. But in coupled inductors and transformers, leakage is the parasitic that limits energy transfer efficiency and creates voltage spikes.

## Stray Capacitance

### Turn-to-Turn Capacitance

Adjacent turns in a winding are conductors separated by insulation — a capacitor. Many turns in series create a distributed capacitance network. The net effect is a single equivalent capacitance in parallel with the inductance:

- **Self-capacitance (C_self):** The effective capacitance of a single winding, typically 1–50 pF depending on winding geometry, wire size, and insulation thickness
- This capacitance forms a resonant circuit with the inductance: the self-resonant frequency (SRF) is f_SRF = 1 / (2π√(L × C_self))
- Above the SRF, the "inductor" becomes capacitive — it's no longer an inductor at all

### Inter-Winding Capacitance

In a transformer, the primary and secondary windings are also conductors separated by insulation. The capacitance between them provides a high-frequency coupling path that bypasses the intended magnetic coupling:

- Common-mode noise on the primary couples directly to the secondary through this capacitance, defeating the galvanic isolation at high frequencies
- In switching power supplies, the fast voltage transitions on the primary winding inject displacement current through the inter-winding capacitance into the secondary, appearing as common-mode noise on the output

**Faraday shields** — a grounded conductive layer between primary and secondary — intercept this displacement current and shunt it to ground, reducing capacitive coupling. This is standard in EMI-sensitive designs.

### Winding-to-Core Capacitance

If the core is conductive (ferrite, powdered iron) and the winding is close to it, there's capacitance from the winding to the core. If the core isn't grounded, it floats at some intermediate voltage, coupling noise capacitively. Grounding the core provides a defined reference but adds another capacitive path.

## Ringing

Leakage inductance and stray capacitance together form an LC tank circuit that rings at its resonant frequency whenever excited by a fast voltage or current transition. This ringing is one of the most visible symptoms of transformer parasitics.

### What Ringing Looks Like

On a scope, ringing appears as a damped oscillation superimposed on the switching waveform — typically at the moment the switching transistor turns off or on. The frequency is:

f_ring = 1 / (2π√(L_leak × C_stray))

Typical ringing frequencies are 1–50 MHz, depending on the transformer construction. The amplitude can be tens of volts on top of the switching waveform.

### Why Ringing Is a Problem

- **Voltage stress:** The ringing adds to the switch voltage. If the switch sees the reflected voltage plus the leakage spike plus the ring peak, the total can exceed the switch's voltage rating
- **EMI:** Ringing at MHz frequencies radiates efficiently from transformer leads and PCB traces. It's a primary source of conducted and radiated EMI in switching power supplies
- **Switching loss:** If the transistor turns on during a ring cycle where current is flowing through the parasitic capacitance, it dissipates that energy as heat

### Snubbers and Clamps

These circuits manage the energy in leakage inductance and damp ringing:

**RC snubber:** A resistor in series with a capacitor, placed across the winding or across the switch. The capacitor absorbs the energy from the leakage spike, and the resistor dissipates it as heat on the next cycle. Simple and effective, but the resistor burns power continuously.

**RCD clamp:** A resistor, capacitor, and diode. The diode conducts only when the voltage exceeds the desired clamp level, charging the capacitor. The resistor discharges the capacitor between cycles. More efficient than an RC snubber because it only absorbs energy from the spike, not from normal operation.

**Active clamp:** Uses a MOSFET and capacitor to capture leakage energy and return it to the circuit. More efficient but more complex. Common in forward converters and active-clamp flyback designs.

**TVS/Zener clamp:** A TVS diode or Zener across the switch clamps the voltage at a fixed level. Simple but dissipates the leakage energy as heat in the TVS. Fine for low-power designs; thermal limits become a problem at high power or high frequency.

## Tips

- Minimize leakage inductance through tight winding coupling — interleave windings where possible
- Size snubbers to just damp the ringing without excessive power dissipation
- Check transformer SRF to ensure it's well above the operating frequency

## Caveats

- Leakage inductance is not a fixed number — It varies with frequency (due to skin and proximity effects changing the current distribution), with DC bias (changing the core's permeability), and with assembly variation (winding tension, layer alignment). Datasheet values are typical at a specific test condition
- Ringing frequency shifts with load — The parasitic capacitance includes the switch's output capacitance (C_oss), which is voltage-dependent. As operating conditions change, the ringing frequency changes, which can move EMI peaks across test frequencies and create intermittent compliance failures
- A snubber that "works" may be wasting significant power — RC snubbers burn power proportional to C × V² × f. On a converter switching at 200 kHz with a 100 pF snubber cap and 100 V swing, that's 0.2 W per snubber — potentially a significant fraction of total losses in a low-power converter. Size the snubber for the minimum capacitance that damps the ring adequately
- Interleaving reduces leakage but increases inter-winding capacitance — There's a direct tradeoff: bringing windings closer together improves magnetic coupling (less leakage) but increases electric field coupling (more capacitance). The design choice depends on whether leakage spikes or common-mode noise is the bigger problem
- Self-resonant frequency applies to inductors too — A filter inductor that's a perfect inductor at 100 kHz may be capacitive at 10 MHz. If it's intended for EMI filtering at high frequencies, check the SRF. Above it, the inductor is actually making things worse

## Bench Relevance

- Ringing on switch node waveforms indicates leakage inductance resonating with stray capacitance — measure the frequency to identify the parasitic values
- Voltage spikes that exceed the switch rating indicate inadequate clamping — add or resize the snubber/clamp
- EMI that concentrates at specific frequencies often correlates with ringing frequencies — damping the ringing reduces the EMI
- A snubber that gets hot is dissipating significant power — verify it's not oversized
